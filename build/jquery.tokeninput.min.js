/*! jquery.tokeninput 2025-09-28 */
(H=>{var a={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,contentType:"json",excludeCurrent:!1,excludeCurrentParameter:"x",prePopulate:null,processPrePopulate:!1,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&#215;",animateDropdown:!0,placeholder:null,theme:null,zindex:999,resultsLimit:null,enableHTML:!1,resultsFormatter:function(t){t=t[this.propertyToSearch];return"<li>"+(this.enableHTML?t:N(t))+"</li>"},tokenFormatter:function(t){t=t[this.propertyToSearch];return"<li><p>"+(this.enableHTML?t:N(t))+"</p></li>"},tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",allowFreeTagging:!1,allowTabOut:!1,autoSelectFirstResult:!1,onResult:null,onCachedResult:null,onAdd:null,onFreeTaggingAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:!1},_={tokenList:"token-input-list",token:"token-input-token",tokenReadOnly:"token-input-token-readonly",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",focused:"token-input-focused",disabled:"token-input-disabled"},q=0,B=1,U=2,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},n=/[&<>"'\/]/g;function N(t){return t=t,String(null==t?"":t).replace(n,function(t){return e[t]})}var s={init:function(t,e){var n=H.extend({},a,e||{});return this.each(function(){H(this).data("settings",n),H(this).data("tokenInputObject",new H.TokenList(this,t,n))})},clear:function(){return this.data("tokenInputObject").clear(),this},add:function(t){return this.data("tokenInputObject").add(t),this},remove:function(t){return this.data("tokenInputObject").remove(t),this},get:function(){return this.data("tokenInputObject").getTokens()},toggleDisabled:function(t){return this.data("tokenInputObject").toggleDisabled(t),this},setOptions:function(t){return H(this).data("settings",H.extend({},H(this).data("settings"),t||{})),this},destroy:function(){var t,e;if(this.data("tokenInputObject"))return this.data("tokenInputObject").clear(),(e=(t=this).parent()).empty(),t.show(),e.append(t),t}};H.fn.tokenInput=function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):s.init.apply(this,arguments)},H.TokenList=function(l,t,o){function d(){var t=H(l).data("settings");return"function"==typeof t.url?t.url.call(t):t.url}function e(t){H(l).data("settings").disabled="boolean"==typeof t?t:!H(l).data("settings").disabled,c.attr("disabled",H(l).data("settings").disabled),k.toggleClass(H(l).data("settings").classes.disabled,H(l).data("settings").disabled),p&&R(H(p),U),g.attr("disabled",H(l).data("settings").disabled)}function n(){var t;s!==(s=c.val())&&(t=k.width()-c.offset().left-k.offset().left,w.html(N(s)||N(o.placeholder)),c.width(Math.min(k.width(),Math.max(t,w.width()+30))))}"string"==typeof t||"function"==typeof t?(H(l).data("settings").url=t,v=d(),void 0===H(l).data("settings").crossDomain&&"string"==typeof v&&(-1===v.indexOf("://")?H(l).data("settings").crossDomain=!1:H(l).data("settings").crossDomain=location.href.split(/\/+/g)[1]!==v.split(/\/+/g)[1])):"object"==typeof t&&(H(l).data("settings").local_data=t),H(l).data("settings").classes?H(l).data("settings").classes=H.extend({},_,H(l).data("settings").classes):H(l).data("settings").theme?(H(l).data("settings").classes={},H.each(_,function(t,e){H(l).data("settings").classes[t]=e+"-"+H(l).data("settings").theme})):H(l).data("settings").classes=_;var a,s,i=[],r=0,u=new H.TokenList.Cache,c=H('<input type="text" autocomplete="off" autocapitalize="off"/>').css({outline:"none"}).attr("id",H(l).data("settings").idPrefix+l.id).on("focus",function(){if(H(l).data("settings").disabled)return!1;null!==H(l).data("settings").tokenLimit&&H(l).data("settings").tokenLimit===r||H(l).data("settings").hintText&&(T.html("<p>"+b(H(l).data("settings").hintText)+"</p>"),O()),k.addClass(H(l).data("settings").classes.focused)}).on("blur",function(){S(),H(l).data("settings").allowFreeTagging&&x(),H(this).val(""),k.removeClass(H(l).data("settings").classes.focused)}).on("keyup keydown blur update",n).on("keydown",function(t){var e,n,a=t.key;switch(a){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":0===this.value.length?(e=m.prev(),n=m.next(),e.length&&e.get(0)===p||n.length&&n.get(0)===p?R(H(p),"ArrowLeft"===a||"ArrowUp"===a?q:B):"ArrowLeft"!==a&&"ArrowUp"!==a||!e.length?"ArrowRight"!==a&&"ArrowDown"!==a||!n.length||L(H(n.get(0))):L(H(e.get(0)))):(n=null,"ArrowDown"===a||"ArrowRight"===a?(n=H(T).find("li").first(),f&&(n=H(f).next())):(n=H(T).find("li").last(),f&&(n=H(f).prev())),P(n));break;case"Backspace":if(e=m.prev(),0===this.value.length)return p?(j(H(p)),g.trigger("change")):e.length&&L(H(e.get(0))),!1;1===H(this).val().length?S():setTimeout(function(){M()},5);break;case"Tab":case"Enter":case"NumpadEnter":case",":if(f)D(H(f).data("tokeninput")),g.trigger("change");else{if(H(l).data("settings").allowFreeTagging){if(H(l).data("settings").allowTabOut&&""===H(this).val())return!0;x()}else if(H(this).val(""),H(l).data("settings").allowTabOut)return!0;t.stopPropagation(),t.preventDefault()}return!1;case"Escape":return S(),!0;default:String.fromCharCode(t.which)&&setTimeout(function(){M()},5)}}),g=(o.placeholder&&c.attr("placeholder",o.placeholder),H(l).hide().val("").on("focus",function(){V(c)}).on("blur",function(){return c.trigger("blur"),g})),p=null,h=0,f=null,k=H("<ul />").addClass(H(l).data("settings").classes.tokenList).on("click",function(t){var e,t=H(t.target).closest("li");t&&t.get(0)&&H.data(t.get(0),"tokeninput")?(t=t,(e=p)&&R(H(p),U),e===t.get(0)?R(t,U):L(t)):(p&&R(H(p),U),V(c))}).on("mouseover",function(t){t=H(t.target).closest("li");t&&p!==this&&t.addClass(H(l).data("settings").classes.highlightedToken)}).on("mouseout",function(t){t=H(t.target).closest("li");t&&p!==this&&t.removeClass(H(l).data("settings").classes.highlightedToken)}).insertBefore(g),m=H("<li />").addClass(H(l).data("settings").classes.inputToken).appendTo(k).append(c),T=H("<div/>").addClass(H(l).data("settings").classes.dropdown).appendTo("body").hide(),w=H("<tester/>").insertAfter(c).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:c.css("fontSize"),fontFamily:c.css("fontFamily"),fontWeight:c.css("fontWeight"),letterSpacing:c.css("letterSpacing"),whiteSpace:"nowrap"}),v=(g.val(""),H(l).data("settings").prePopulate||g.data("pre"));function y(){null!==H(l).data("settings").tokenLimit&&r>=H(l).data("settings").tokenLimit&&(c.hide(),S())}function b(t){return H(l).data("settings").enableHTML?t:N(t)}function x(){var t=(c.val()||"").trim().split(H(l).data("settings").tokenDelimiter);H.each(t,function(t,e){var n;e&&("function"==typeof H(l).data("settings").onFreeTaggingAdd&&(e=H(l).data("settings").onFreeTaggingAdd.call(g,e)),(n={})[H(l).data("settings").tokenValue]=n[H(l).data("settings").propertyToSearch]=e,D(n))})}function C(t){var e=H(H(l).data("settings").tokenFormatter(t)),n=!0===t.readonly,n=(n&&e.addClass(H(l).data("settings").classes.tokenReadOnly),e.addClass(H(l).data("settings").classes.token).insertBefore(m),n||H("<span>"+H(l).data("settings").deleteText+"</span>").addClass(H(l).data("settings").classes.tokenDelete).appendTo(e).on("click",function(){if(!H(l).data("settings").disabled)return j(H(this).parent()),g.trigger("change"),!1}),t);H.data(e.get(0),"tokeninput",t),i=i.slice(0,h).concat([n]).concat(i.slice(h)),h++,A(i,g),r+=1,null!==H(l).data("settings").tokenLimit&&r>=H(l).data("settings").tokenLimit&&(c.hide(),S())}function D(n){var t=H(l).data("settings").onAdd;if(0<r&&H(l).data("settings").preventDuplicates){var a=null;if(k.children().each(function(){var t=H(this),e=H.data(t.get(0),"tokeninput");if(e&&e[o.tokenValue]===n[o.tokenValue])return a=t,!1}),a)return L(a),m.insertAfter(a),void V(c)}c.width(1),(null===H(l).data("settings").tokenLimit||r<H(l).data("settings").tokenLimit)&&(C(n),c.attr("placeholder",null),y()),c.val(""),S(),"function"==typeof t&&t.call(g,n)}function L(t){H(l).data("settings").disabled||(t.addClass(H(l).data("settings").classes.selectedToken),p=t.get(0),c.val(""),S())}function R(t,e){t.removeClass(H(l).data("settings").classes.selectedToken),p=null,e===q?(m.insertBefore(t),h--):e===B?(m.insertAfter(t),h++):(m.appendTo(k),h=r),V(c)}function j(t){var e=H.data(t.get(0),"tokeninput"),n=H(l).data("settings").onDelete,a=t.prevAll().length;h<a&&a--,t.remove(),p=null,V(c),0===(i=i.slice(0,a).concat(i.slice(a+1))).length&&c.attr("placeholder",o.placeholder),a<h&&h--,A(i,g),--r,null!==H(l).data("settings").tokenLimit&&(c.show().val(""),V(c)),"function"==typeof n&&n.call(g,e)}function A(t,e){t=H.map(t,function(t){return"function"==typeof H(l).data("settings").tokenValue?H(l).data("settings").tokenValue.call(this,t):t[H(l).data("settings").tokenValue]});e.val(t.join(H(l).data("settings").tokenDelimiter))}function S(){T.hide().empty(),f=null}function O(){T.css({position:"absolute",top:k.offset().top+k.outerHeight(!0),left:k.offset().left,width:k.width(),"z-index":H(l).data("settings").zindex}).show()}(v=H(l).data("settings").processPrePopulate&&"function"==typeof H(l).data("settings").onResult?H(l).data("settings").onResult.call(g,v):v)&&v.length&&H.each(v,function(t,e){C(e),y(),c.attr("placeholder",null)}),H(l).data("settings").disabled&&e(!0),"function"==typeof H(l).data("settings").onReady&&H(l).data("settings").onReady.call(),this.clear=function(){k.children("li").each(function(){0===H(this).children("input").length&&j(H(this))})},this.add=function(t){D(t)},this.remove=function(a){k.children("li").each(function(){if(0===H(this).children("input").length){var t,e=H(this).data("tokeninput"),n=!0;for(t in a)if(a[t]!==e[t]){n=!1;break}n&&j(H(this))}})},this.getTokens=function(){return i},this.toggleDisabled=function(t){e(t)},n();var z=new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g");function I(t){return t.replace(z,"\\$&")}function E(t,e,n){return t.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+I(e)+")(?![^<>]*>)(?![^&;]+;)","g"),e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+I(n)+")(?![^<>]*>)(?![^&;]+;)","gi"),function(t,e){return"<b>"+b(e)+"</b>"}))}function F(a,t){var e,s,i,o;e=t,H(l).data("settings").excludeCurrent&&(s=H(l).data("tokenInputObject").getTokens(),i=[],s.length)&&(H.each(e,function(t,n){var a=!0;H.each(s,function(t,e){if(n[H(l).data("settings").propertyToSearch]===e[H(l).data("settings").propertyToSearch])return a=!1}),a&&i.push(n)}),e=i),(t=e)&&t.length?(T.empty(),o=H("<ul/>").appendTo(T).on("mouseover",function(t){P(H(t.target).closest("li"))}).on("mousedown",function(t){return D(H(t.target).closest("li").data("tokeninput")),g.trigger("change"),!1}).hide(),H(l).data("settings").resultsLimit&&t.length>H(l).data("settings").resultsLimit&&(t=t.slice(0,H(l).data("settings").resultsLimit)),H.each(t,function(t,e){var n=E(n=H(l).data("settings").resultsFormatter(e),e[H(l).data("settings").propertyToSearch],a);n=H(n).appendTo(o),t%2?n.addClass(H(l).data("settings").classes.dropdownItem):n.addClass(H(l).data("settings").classes.dropdownItem2),0===t&&H(l).data("settings").autoSelectFirstResult&&P(n),H.data(n.get(0),"tokeninput",e)}),O(),H(l).data("settings").animateDropdown?o.slideDown("fast"):o.show()):H(l).data("settings").noResultsText&&(T.html("<p>"+b(H(l).data("settings").noResultsText)+"</p>"),O())}function P(t){t&&(f&&(H(f).removeClass(H(l).data("settings").classes.selectedDropdownItem),f=null),t.addClass(H(l).data("settings").classes.selectedDropdownItem),f=t.get(0))}function M(){var i=c.val();i&&i.length&&(p&&R(H(p),B),i.length>=H(l).data("settings").minChars?(H(l).data("settings").searchingText&&(T.html("<p>"+b(H(l).data("settings").searchingText)+"</p>"),O()),clearTimeout(a),a=setTimeout(function(){var n,t,e=i,a=e+d(),s=u.get(a);s?("function"==typeof H(l).data("settings").onCachedResult&&(s=H(l).data("settings").onCachedResult.call(g,s)),F(e,s)):H(l).data("settings").url?(s=d(),n={data:{}},-1<s.indexOf("?")?(t=s.split("?"),n.url=t[0],t=t[1].split("&"),H.each(t,function(t,e){e=e.split("=");n.data[e[0]]=e[1]})):n.url=s,n.data[H(l).data("settings").queryParam]=e,n.type=H(l).data("settings").method,n.dataType=H(l).data("settings").contentType,H(l).data("settings").crossDomain&&(n.dataType="jsonp"),H(l).data("settings").excludeCurrent&&(t=H(l).data("tokenInputObject").getTokens(),s=H.map(t,function(t){return"function"==typeof H(l).data("settings").tokenValue?H(l).data("settings").tokenValue.call(this,t):t[H(l).data("settings").tokenValue]}),n.data[H(l).data("settings").excludeCurrentParameter]=s.join(H(l).data("settings").tokenDelimiter)),n.success=function(t){u.add(a,H(l).data("settings").jsonContainer?t[H(l).data("settings").jsonContainer]:t),"function"==typeof H(l).data("settings").onResult&&(t=H(l).data("settings").onResult.call(g,t)),c.val()===e&&F(e,H(l).data("settings").jsonContainer?t[H(l).data("settings").jsonContainer]:t)},o.onSend&&o.onSend(n),H.ajax(n)):H(l).data("settings").local_data&&(t=H.grep(H(l).data("settings").local_data,function(t){return-1<t[H(l).data("settings").propertyToSearch].toLowerCase().indexOf(e.toLowerCase())}),u.add(a,t),"function"==typeof H(l).data("settings").onResult&&(t=H(l).data("settings").onResult.call(g,t)),F(e,t))},H(l).data("settings").searchDelay)):S())}function V(e){setTimeout(function(){var t=e&&e[0]?e[0]:e;t&&"function"==typeof t.focus&&t.focus()},50)}},H.TokenList.Cache=function(t){var n={},a=0,s=H.extend({max_size:500},t),i=function(){n={},a=0};this.add=function(t,e){a>s.max_size&&i(),n[t]||(a+=1),n[t]=e},this.get=function(t){return n[t]}}})(jQuery);